import{r as v,o as j,a as l,b as i,c,d as a,w as s,F as k,e as p,f as b,g as I,h as u,t as d,n as M,i as h}from"./app-20133a23.js";const q=p("div",{id:"map",style:{width:"100vw",height:"100vh"}},null,-1),D={key:0,class:"p-4"},N={key:0,slot:"overline"},R={slot:"headline"},S={key:1,slot:"supporting-text"},V=p("div",{slot:"headline"},"Bienvenue sur Transit Tracker Regio!",-1),O=p("form",{slot:"content",id:"dialog-intro",method:"dialog"}," Regio n'est pas un planficateur d'itinéraire. C'est plutôt un projet pour voir les liasons de transports en commun existantes. À chaque déplacement, assurez-vous de vérifier les horaires, les tarifs, les modes de réservations auprès du transporteur. ",-1),F={slot:"actions"},W={__name:"Map",props:{routes:Object,stops:Object},setup(x){const _=x,m=v([]),y=v(!0),g=v(!1);mapboxgl.accessToken="pk.eyJ1IjoiZmVsaXhpbngiLCJhIjoiY2xqZXpkMzBkMmxkaDNtbDRiOTg0MDdxeCJ9.pX3IAecDleBe0ngEnxJQGw";let e;j(()=>{e=new mapboxgl.Map({container:"map",center:[-65,49],zoom:9,style:"mapbox://styles/mapbox/streets-v12",dragRotate:!1,hash:!0,transformRequest:(o,r)=>{if(r==="Tile"&&o.startsWith("https://transit.land"))return{url:o,headers:{apikey:"3CobN9u6gUbqfIbIG4eHUWIcMbgnEsdp"}}}}),e.on("load",()=>{e.addSource("rg-routes",{type:"geojson",data:_.routes}),e.addSource("rg-stops",{type:"geojson",data:_.stops}),e.addSource("tl-routes",{type:"vector",tiles:["https://transit.land/api/v2/tiles/routes/tiles/{z}/{x}/{y}.pbf"],maxzoom:14}),e.addSource("tl-stops",{type:"vector",tiles:["https://transit.land/api/v2/tiles/stops/tiles/{z}/{x}/{y}.pbf"],maxzoom:14}),e.addLayer({id:"rg-routes",type:"line",source:"rg-routes",paint:{"line-color":["get","route_color"],"line-width":6}}),e.addLayer({id:"rg-stops",type:"circle",source:"rg-stops",paint:{"circle-color":["get","agency_color"],"circle-radius":5,"circle-stroke-color":["get","agency_text_color"],"circle-stroke-width":2}}),e.addLayer({id:"tl-routes",type:"line",source:"tl-routes","source-layer":"routes",paint:{"line-color":["get","route_color"],"line-width":6},layout:{visibility:"none"}}),e.addLayer({id:"tl-stops",type:"circle",source:"tl-stops","source-layer":"stops",paint:{"circle-color":"#f7ae56","circle-radius":5,"circle-stroke-color":"#ffffff","circle-stroke-width":2},layout:{visibility:"none"}});const o=turfBbox(_.routes);e.fitBounds(o,{padding:20})}),e.on("click",o=>{const r=e.queryRenderedFeatures(o.point).filter(({layer:n})=>n.id.startsWith("rg-")||n.id.startsWith("tl-"));console.log(r),m.value=r})});const w=()=>{const o=e.getLayoutProperty("tl-routes","visibility")==="visible";e.setLayoutProperty("tl-routes","visibility",o?"none":"visible"),e.setLayoutProperty("tl-stops","visibility",o?"none":"visible"),g.value=!o};return(o,r)=>{const n=l("md-icon"),C=l("md-list-item"),z=l("md-list"),T=l("md-elevated-card"),B=l("md-text-button"),L=l("md-dialog"),f=l("md-fab");return i(),c(k,null,[q,a(T,{class:"absolute left-8 top-24 w-96"},{default:s(()=>[m.value.length?(i(),b(z,{key:1,class:"bg-transparent py-4"},{default:s(()=>[(i(!0),c(k,null,I(m.value,t=>(i(),b(C,{key:t.id,interactive:t.properties.route_url||t.properties.onestop_id,href:t.properties.route_url??`https://transit.land/onestop-id/${t.properties.onestop_id}`,target:"_blank",style:M({"--md-list-item-leading-icon-color":t.properties.route_color})},{default:s(()=>[t.properties.agency_name?(i(),c("div",N,d(t.properties.agency_name),1)):h("",!0),p("div",R,d(t.properties.stop_name??t.properties.route_short_name)+" "+d(t.properties.route_long_name),1),t.properties.stop_code?(i(),c("div",S,d(t.properties.stop_code),1)):h("",!0),t.source.includes("-routes")?(i(),b(n,{key:2,slot:"start"},{default:s(()=>[u("route")]),_:1})):h("",!0)]),_:2},1032,["interactive","href","style"]))),128))]),_:1})):(i(),c("p",D,"Cliquez une ligne ou un arrêt pour voir les détails"))]),_:1}),a(L,{open:y.value,onClose:r[0]||(r[0]=t=>y.value=!1)},{default:s(()=>[V,O,p("div",F,[a(B,{form:"dialog-intro",value:"ok"},{default:s(()=>[u("OK")]),_:1})])]),_:1},8,["open"]),a(f,{"aria-label":"Info",variant:"primary",class:"absolute bottom-9 right-4",onClick:r[1]||(r[1]=t=>y.value=!0)},{default:s(()=>[a(n,{slot:"icon"},{default:s(()=>[u("info")]),_:1})]),_:1}),a(f,{label:g.value?"Cacher Transitland":"Afficher Transitland",class:"absolute right-8 top-24",onClick:w,size:"small"},{default:s(()=>[a(n,{slot:"icon"},{default:s(()=>[u(d(g.value?"visibility_off":"visibility"),1)]),_:1})]),_:1},8,["label"])],64)}}};export{W as default};
